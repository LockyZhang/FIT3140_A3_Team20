<!-- SPIKE 1 - SerialPort and Socket.IO Client -->
<!-- Author: Simon Caven -->
<!-- Last Modified: 13/04/2017 -->



<html>

<head>
<style>
div.title{
  color:aqua;
}

div.header{
  color:crimson;
}
</style>

</head>

<body>
  <h1 style="color:darkred">SPIKE1 - SOCKET-IO RESPONSE TIMES</h1>
  
  <div class="title">LAST RESPONSE TIME</div><div id="Response"></div>
  <div class="header"> Count</div><div id="Count"></div>
  <div class="header"> Running Average</div><div id="Average"></div>
  <pre></pre>
  <div class="title">SERVER</div><div id="Server"></div>
  <div class="title">CLIENT</div><div id="Client"></div>
  <p>***Millseconds since 1/1/1970***</p>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    var socket = io();
    var clienTime;
    var jsDate;
    var responseTime;
    var count = 0;
    var average;
    var total = 0;
    

    socket.on('server', function (serverTime) {
      jsDate = new Date();
      clientTime = jsDate.getTime();
      responseTime = clientTime - serverTime;
      count += 1;
      total = total + responseTime;
      average = total/Number(count);

      document.getElementById("Response").innerHTML =  responseTime;
      document.getElementById("Server").innerHTML =  serverTime;
      document.getElementById("Client").innerHTML =  clientTime;
      document.getElementById("Count").innerHTML =  count;
      document.getElementById("Average").innerHTML =  average;
    });
    
    
  </script>
</body>
</html>